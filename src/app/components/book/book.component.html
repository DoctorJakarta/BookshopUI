<vdl-title-bar title="Books"></vdl-title-bar>

<vdl-panel *ngIf="book && (pageType==PAGE_TYPE.NEW_BOOK || pageType==PAGE_TYPE.EDIT_BOOK)" class="smallForm">
    <vdl-form-field label="Title" class="smallField">
        <input vdlInput type="text" [(ngModel)]="book.title" required/>
    </vdl-form-field>
    <vdl-form-field label="Author" class="smallField">
        <input vdlInput type="text" [(ngModel)]="book.author"/>
    </vdl-form-field>
    <vdl-form-field label="Year" class="smallField">
        <input vdlInput type="text" [(ngModel)]="book.year"/>
    </vdl-form-field>
     <vdl-form-field label="Comment(private)" class="smallField">
        <input vdlInput type="text" [(ngModel)]="book.comment"/>
    </vdl-form-field>
   <vdl-form-field VdlTextareaAutosize label="Description">
        <textarea vdlInput type="text" [(ngModel)]="book.desc"></textarea>
    </vdl-form-field>
    <vdl-form-field label="Date Bought" class="smallField">
        <input vdlInput type="text" [(ngModel)]="book.dateBought" placeholder="YYYY-MM-DD"/>
    </vdl-form-field>
    <vdl-form-field label="Date Sold" class="smallField">
        <vdl-checkbox label="Sold" [(ngModel)]="book.sold"></vdl-checkbox>
        <input vdlInput type="text" [(ngModel)]="book.dateSold" placeholder="YYYY-MM-DD"/>
    </vdl-form-field>
     
    <table border=1>
        <tr>
            <th>Price</th>
            <th>Price Bought</th>
            <th>Price Min.</th>
            <th>Price Max.</th>
        </tr>
        <tr>
            <td style="font-weight: boldest">$ <input vdlInput type="text" [(ngModel)]="book.price"/>.00</td>
            <td style="color:grey">$ <input vdlInput type="text" [(ngModel)]="book.priceBought" />.00</td>
            <td style="color:grey">$ <input vdlInput type="text" [(ngModel)]="book.priceMin"/>.00</td>
            <td style="color:grey">$ <input vdlInput type="text" [(ngModel)]="book.priceMax"/>.00</td>
        </tr>
    </table>

    <p *ngIf="book.id">References
        <button vdl-icon-button (click)="openReferenceDialog()">
            <vdl-icon fontSet="fontawesome" fontIcon="fa-plus-circle"></vdl-icon>
        </button>
    </p>
    <div *ngFor="let r of book.references">
        <button vdl-icon-button (click)="deleteReference(r)">
            <vdl-icon fontSet="fontawesome" fontIcon="fa-trash"></vdl-icon>
        </button>      
         <button vdl-icon-button (click)="openReferenceDialog(r)">
            <vdl-icon fontSet="fontawesome" fontIcon="fa-cog"></vdl-icon>
        </button>      
        {{r.price}}:  <a href='{{r.url}}' targer='_blank'>{{r.url}}</a>
    </div>
    <div>
        <label for="options">Tags:</label>
        <div *ngFor="let cb of tagCheckboxMap | keyvalue ">
            <label>
                <input type="checkbox" value="{{cb.key}}" [(ngModel)]="cb.value.checked">{{cb.value.name}}
            </label>
        </div>

    </div>

    <button vdl-primary-button (click)="upsertBook()">{{book.id ? 'Update' : 'Create'}}</button>
    <button vdl-secondary-button (click)="deleteBook()">Delete</button>
    <button vdl-secondary-button (click)="listBooks()">Cancel</button>
</vdl-panel>

<vdl-panel *ngIf="pageType==PAGE_TYPE.LIST_BOOKS">
    <button vdl-primary-button (click)='newBook()'>New Book</button>
    <table cellpadding=20>
		<tr>
            <th colspan=3></th>
            <th colspan=4>Price</th>
        </tr>
		<tr>
            <th>Year</th>
            <th>Author</th>
            <th>Title</th>
            <th>Sell</th>
            <th>Bought</th>
            <th>Min</th>
            <th>Max</th>
            <th>Sold</th>
        </tr>
		<tr *ngFor='let b of books'>
			<td>{{b.year}}</td>
			<td>{{b.author}}</td>
			<td>{{b.title}}
                <button *ngIf="b.desc" vdl-icon-button vdlTooltip={{b.desc}}>
                    <vdl-icon fontSet="fontawesome" fontIcon="fa-info-circle"></vdl-icon>
                </button>
                 <button *ngIf="b.comment" vdl-icon-button vdlTooltip={{b.comment}}>
                    <vdl-icon fontSet="fontawesome" fontIcon="fa-copyright"></vdl-icon>
                </button>
           </td>
			<td>{{b.price}}</td>
			<td>{{b.priceBought}}</td>
			<td>{{b.priceMin}}</td>
			<td>{{b.priceMax}}</td>
			<td *ngIf="b.sold ">
                <vdl-icon fontSet="fontawesome" fontIcon="fa-check"></vdl-icon>
            </td>
			<td *ngIf="!b.sold "></td>
            <td>
                <button vdl-icon-button (click)="editBook(b.id)">
                    <vdl-icon fontSet="fontawesome" fontIcon="fa-cog"></vdl-icon>
                </button>
            </td>
            <td>
                <button vdl-icon-button (click)="deleteBook(b.id)">
                    <vdl-icon fontSet="fontawesome" fontIcon="fa-trash"></vdl-icon>
                </button>
            </td>      
        </tr>
	</table>
List books

</vdl-panel>



